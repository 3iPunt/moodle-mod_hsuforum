define(["jquery","core/notification","core/ajax","core/templates","core/fragment","core/str"],function(a,b,c,d,e,f,g){return{advancedEditor:function(b,c){a(b).on({click:function(b){b.preventDefault();var d=a(b.target).parent(".hsuforum-post-body");0==d.length&&(d=a(b.target).parent(".editor_atto_wrap")),f(d,c)}},".hsuforum-use-advanced");var f=function(a,b){var c="advanced",d=a.find(".editor_atto"),e=a.find(".mceEditor"),f="";(1==d.length||1==e.length)&&(c=a.find(".hsuforum-use-advanced").text()==M.util.get_string("useadvancededitor","hsuforum")?"show":"simple"),f=d.length?d:e,g(c,f,a,b)},g=function(b,c,f,g){var h=f.find('div[id^="editor-target-container-"].hsuforum-textarea'),i=f.find('div[id^="editor-target-container-"].editor_atto_content');if("advanced"==b){var j,k=a("input[name='contextid']").val(),l=h.attr("id");j={contextid:k,cmid:g,id:l},e.loadFragment("mod_hsuforum","editor",k,j).done(function(b,c){d.replaceNodeContents(a("#editor-info"),b,c),f.find(".hsuforum-use-advanced").text(M.util.get_string("hideadvancededitor","hsuforum")),h.html().length>0&&(checkEditArea=setInterval(function(){var a=f.find('div[id^="editor-target-container-"].editor_atto_content');1==a.length&&(a.html(h.html()),clearInterval(checkEditArea))},100))})}else"simple"==b?(h.html(i.html()),h.show(),c.hide(),f.find(".hsuforum-use-advanced").text(M.util.get_string("useadvancededitor","hsuforum"))):"show"==b&&(f.find(".hsuforum-use-advanced").text(M.util.get_string("hideadvancededitor","hsuforum")),i.html(h.html()),h.hide(),c.show())}},initialize:function(a,b){this.advancedEditor(a,b)}}});